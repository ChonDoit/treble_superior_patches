From 927f4ab5096925e05cc8b580303a8341a7c96a0c Mon Sep 17 00:00:00 2001
From: ChonDoit <thphantomblog@gmail.com>
Date: Sat, 19 Aug 2023 19:29:11 +0000
Subject: [PATCH] Allow system apps to access sysfs_leds

---
 prebuilts/api/28.0/private/coredomain.te | 1 +
 prebuilts/api/29.0/private/coredomain.te | 1 +
 prebuilts/api/30.0/private/coredomain.te | 1 +
 prebuilts/api/31.0/private/coredomain.te | 1 +
 prebuilts/api/32.0/private/coredomain.te | 1 +
 prebuilts/api/33.0/private/coredomain.te | 1 +
 private/coredomain.te                    | 1 +
 7 files changed, 7 insertions(+)

diff --git a/prebuilts/api/28.0/private/coredomain.te b/prebuilts/api/28.0/private/coredomain.te
index 23224c323..ed0fc2cac 100644
--- a/prebuilts/api/28.0/private/coredomain.te
+++ b/prebuilts/api/28.0/private/coredomain.te
@@ -11,5 +11,6 @@ neverallow {
     # generic access to sysfs_type
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
diff --git a/prebuilts/api/29.0/private/coredomain.te b/prebuilts/api/29.0/private/coredomain.te
index 419d9fe76..001d74a30 100644
--- a/prebuilts/api/29.0/private/coredomain.te
+++ b/prebuilts/api/29.0/private/coredomain.te
@@ -11,6 +11,7 @@ neverallow {
     # generic access to sysfs_type
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
diff --git a/prebuilts/api/30.0/private/coredomain.te b/prebuilts/api/30.0/private/coredomain.te
index f13d98a1d..b70e01323 100644
--- a/prebuilts/api/30.0/private/coredomain.te
+++ b/prebuilts/api/30.0/private/coredomain.te
@@ -11,6 +11,7 @@ neverallow {
     # generic access to sysfs_type
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
diff --git a/prebuilts/api/31.0/private/coredomain.te b/prebuilts/api/31.0/private/coredomain.te
index b7f4f5d18..5ac2fc237 100644
--- a/prebuilts/api/31.0/private/coredomain.te
+++ b/prebuilts/api/31.0/private/coredomain.te
@@ -39,6 +39,7 @@ neverallow {
     # generic access to sysfs_type
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
diff --git a/prebuilts/api/32.0/private/coredomain.te b/prebuilts/api/32.0/private/coredomain.te
index b7f4f5d18..5ac2fc237 100644
--- a/prebuilts/api/32.0/private/coredomain.te
+++ b/prebuilts/api/32.0/private/coredomain.te
@@ -39,6 +39,7 @@ neverallow {
     # generic access to sysfs_type
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
diff --git a/prebuilts/api/33.0/private/coredomain.te b/prebuilts/api/33.0/private/coredomain.te
index e4c9a5218..3e83ae133 100644
--- a/prebuilts/api/33.0/private/coredomain.te
+++ b/prebuilts/api/33.0/private/coredomain.te
@@ -40,6 +40,7 @@ neverallow {
     -apexd
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
diff --git a/private/coredomain.te b/private/coredomain.te
index e4c9a5218..3e83ae133 100644
--- a/private/coredomain.te
+++ b/private/coredomain.te
@@ -40,6 +40,7 @@ neverallow {
     -apexd
     -ueventd
     -vold
+    -system_app
 } sysfs_leds:file *;
 ')
 
-- 
2.34.1

